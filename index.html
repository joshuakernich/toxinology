<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Toxinology</title>
  <style type="text/css">

    @font-face {
      font-family: HeaderFont;
      src: url(Oswald-Bold.ttf);
      font-weight: bold;
    }

    @font-face {
      font-family: HeaderFont;
      src: url(Oswald-ExtraLight.ttf);
      font-weight: normal;
    }

    @font-face {
      font-family: BodyFont;
      src: url(Quicksand-Light.ttf);
      font-weight: normal;
    }

    @font-face {
      font-family: BodyFont;
      src: url(Quicksand-Bold.ttf);
      font-weight: bold;
    }

    body{
      font-family: BodyFont;
      background: #f1faee;
      color:  #1d3557;
      margin: 0px;
      line-height: 1.5;


      --blue: #1d3557;
      --red: #E63946;
      --gray: rgba(29, 53, 87, 0.2);
      --white: #F1FAEE;
      overflow: hidden;
    }

    .header{
      padding: 20px;
      
      text-align: left;
    }

    .search-pillar-header{
      font-weight: normal;
      font-size: 30px;
      
      font-family: HeaderFont;
      
      margin-bottom: 20px;
    }

    button{
      font:  inherit;
      background: #e63946;
      border:  none;
      color:  white;
      border-radius: 5px;
      flex-grow: 1;
      padding: 10px 30px;
      font-size: 15px;
      flex: 1;
    }

    button.secondary{
      border: 1px solid var(--blue);
      font-size: 12px;
      padding: 5px 8px;
      color: var(--blue);
      background: transparent;
    }

    .pillars{
      display: flex;
    }

    .search-pillar{
      
      text-align: left;
      
      
      display: inline-block;
      background: var(--blue);
      color: #F1FAEE;
      position: relative;

    }


    .search-pillar-content{
      
    }

    .organism-pillar{
      padding: 20px;
      width: 500px;
      display: inline-block;
      vertical-align: top;
      text-align: left;
      flex-grow: 1;
      height: 100vh;
      box-sizing: border-box;
      overflow: auto;
      position: relative;
    }

    p{
      margin:  0px;
    }

    input{
      display: block;
      width: 100%;
      font: inherit;
      padding: 10px;
      box-sizing: border-box;
    }

    h2{
      font-size: 20px;
      font-weight: normal;
      margin: 0px;
      font-size: 30px;

    }

    h3{
      font-size: 12px;
      font-weight: normal;
      margin: 0px;
    }

    hr{
      background: var(--gray);
      border: none;
      height: 1px;
    }

    .question{
      font-size: 15px;
      margin-bottom: 20px;
    }

    .question-text{
      margin-bottom: 0px;
    }

    .question-subtext{
      font-size: 10px;
      opacity: 0.5;
      margin-bottom: 10px;
    }

    .hint{
      font-size: 12px;
    }

    .options{
      list-style-type: none;
      padding: 0px;
      margin: 0px;
      margin-top: 10px;
      display: flex;
      gap: 10px;
      display: none;
    }

    .options .option{
      text-align: center;
      padding: 5px 20px;
      background: #e63946;
      color: white;
      flex-grow: 1;
    }

    .advice{
      padding: 10px;
      border: 1px solid #e63946;
      padding-left: 45px;
      background-image: url('./alert-triangle.svg');
      background-position: 10px 10px;
      background-repeat: no-repeat;
    }

    .c-input{
      position: relative;
    }

    .c-dangerousness{
      text-align: center;
      position: relative;
      color: var(--red);
    }

    .c-dangerousness p{
      margin-top: 5px;
      position: absolute;
      bottom: 0px;
      width: 100%;
      font-weight: bold;
    }

    .needle{
      position: absolute;
      top: 75px;
      left: 50%;
      transform: rotate(65deg);
      transform-origin: 0 0;
      display: none;
    }

    .needle:before{
      content: "";
      width: 0; 
      height: 0; 
      border-left: 4px solid transparent;
      border-right: 4px solid transparent;
      border-bottom: 30px solid var(--red);
      position: absolute;
      left: -2px;
      bottom: 0px;
    }

    .needle:after{
      content: "";
      border: 2px solid var(--red);
      background: var(--white);
      position: absolute;
      left: -5px;
      top: -5px;
      width: 10px;
      height: 10px;
      border-radius: 10px;
    }


    .prompts{
      position: absolute;
      top: 1px;
      left: 0px;
      list-style-type: none;
      padding: 0px;
      margin: 0px;
      bottom: 1px;
      overflow: hidden;
      pointer-events: none;
      color: #ccc;
    }

    .prompts p{
      padding: 10px;
      position: relative;
    }

    .c-lister{
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .c-lister button{
      background: none;
      color: var(--white);
      padding: 10px 15px;
    }

    .c-lister button:before{
      content: '+';
      margin-right: 10px;
      display: inline-block;
    }

    .c-lister ul{
      margin: 0px;
      padding: 0px;
      list-style-type: none;
    }

    .c-lister li{
      list-style-type: none;
      padding: 10px 15px;
      border-bottom: rgba(255, 255, 255, 0.1);
      background: rgba(255, 255, 255, 0.1);
      position: relative;
    }

    .c-lister li:after{
      content: "Ã—";
      position: absolute;
      font-size: 30px;
      top: 0px;
      right: 10px;
      line-height: 40px;
      opacity: 0.2;
    }

    .c-selector{
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .selector-option{
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      flex-grow: 1;
      width: 80px;
      
     
      text-align: center;
      
      display: flex;
      justify-content: center;
      font-size: 12px;
    }



    .selector-option img{
      width: 30px;
      height: 30px;
      opacity: 0.5;
    }

    .selector-suboption{
      text-align: center;
      padding: 5px;
      border-right: 1px solid rgba(255, 255, 255, 0.1);
    }

    .selector-suboption:last-of-type{
      border-right: none;
    }

    p.capsule{
      
      border: 1px solid var(--gray);
      color: var(--blue);
      display: inline-block;
      padding: 5px;
      font-size: 11px;
      margin-right: 5px;

      background: white;
    }

    p.capsule.alert{
      background: var(--red);
    }

    p.capsule.clear{
      border-color: rgba(255,255,255,0.2);
      color: rgba(255,255,255,0.4);
      background: none;
    }

    .organisms{
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      text-align: center;
      margin-top: 10px;
    }

    .organism{
      flex-grow: 1;
      border: 1px solid var(--gray);
      padding: 10px;
      background: rgba(255, 255, 255, 0.5);
      position: relative;
    }

    .organism.risky:after{
      content: "";
      font-weight: bold;
      background: var(--red);
      padding: 5px;
      color: white;
      background-image: url('./icons/alert-triangle.svg');
      background-position: center;
      background-repeat: no-repeat;
      background-size: 15px;
      position: absolute;
      top: 5px;
      left: 5px;
      width: 15px;
      height: 15px;
    }

    select{
      border: 1px solid var(--gray);
      background: rgba(255, 255, 255, 0.5);
      color: inherit;
      font: inherit;
      font-size: 15px;
      padding: 5px
    }

    input{
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.1);

    }

    .organisms-header{
      display: flex;
      flex:1;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .modal{
      position: absolute;
      top: 0px;
      left: 0px;
      right: 0px;
      overflow: auto;
      background: rgba(200,200,200,0.8);
      height: 100vh;
      display: none;
      z-index: 1;
      background: var(--white);
    }

    .modal.active{
      display: block;
    }

    .modal-panel{
      background: var(--white);
      /*border-left: 1px solid var(--blue);
      border-right: 1px solid var(--blue);*/
      max-width: 800px;
      margin: auto;
      text-align: left;
    }

    .modal-panel.diagnosis{
      max-width: 440px;
      background: var(--blue);
      margin-left: 0px;
    }

    .dangerousness path:nth-of-type(1){ stroke: #54dd82 }
    .dangerousness path:nth-of-type(2){ stroke: #abdd54; }
    .dangerousness path:nth-of-type(3){ stroke: #e5c339; }
    .dangerousness path:nth-of-type(4){ stroke: #dd9954; }
    .dangerousness path:nth-of-type(5){ stroke: var(--red); }

    
    

    .treatment p{
      margin-bottom: 20px;
    }

    .capsule-list{
      border: 1px solid var(--gray);
      color: var(--blue);
      display: inline-block;
      
      font-size: 11px;
      margin-right: 5px;

      background: rgba(255, 255, 255, 0.5);
    }

    .capsule-list span{
      border-right: 1px solid var(--gray);
      padding: 5px 10px;
      display: inline-block;
    }

    .capsule-list span:last-of-type{
      border-right: none;
    }

    img.icon{
      width: 12px;
      stroke: var(--blue);
      display: inline-block;
      margin-right: 5px;
      vertical-align: middle;
    }

    .first-aid{
      list-style-type: none;
      gap: 10px;
      padding: 0px;
    }

    .first-aid li{
      border-left: 2px solid var(--blue);
      margin: 0px;
      padding-left: 10px;
      margin-bottom: 10px;
    }

    .first-aid h3{
      font-weight: bold;
      margin: 0px;
      margin-bottom: 10px;
      display: inline;
    }

    .modal-header{
      /*background: var(--blue);
      color: var(--white);*/
      padding: 20px;
      padding-bottom: 0px;
    }

    .modal-content{
      padding: 20px;
      padding-top: 0px;
    }

    .logo{
      font-family: HeaderFont;
      font-weight: normal;
      font-size: 30px;
    }

    .logo:before{
      content:"TOXIN";
      font-weight: bold;
    }

    .logo:after{
      content: "OLOGY.com";

    }

    /*.modal-header .capsule{
      color: var(--white);
      border-color: var(--white);
      background: transparent;
    }*/

    .modal-header .capsule-list{
      background: white;
      color: var(--blue);
      border-color: var(--gray);
    }

    .modal-header .capsule-list span{
      border-color: var(--gray);
    }

    .modal-header img{
      border-color: var(--blue);
    }
   

    .modal-menu{
      list-style-type: none;
      padding: 0px;
      margin: 0px;
      margin-bottom: 20px;
      text-align: left;
      display: block;
      display: none;
      
    }

    .modal-menu li{
      font-size: 12px;
      margin-right: 5px;
      display: inline-block;
      background: white;
      border: 1px solid var(--gray);
      padding: 5px 10px;
    }


    .modal-menu li:before{
      content: "";
      width: 20px;
      height: 20px;
      background-image: url('./icons/first-aid.png');
      background-position: center;
      background-size: 20px;
      background-repeat: no-repeat;
      display: inline-block;
      display: none;
    }

    .modal-menu li:nth-of-type(2):before{ background-image:url('./icons/diagnosis.png') }
    .modal-menu li:nth-of-type(3):before{ background-image:url('./icons/treatment.png') }
    .modal-menu li:nth-of-type(4):before{ background-image:url('./icons/lab-notes.png') }

    .risk.high{
      font-weight: bold;
      background: var(--red);
      padding: 5px 10px;
      color: white;
    }

    .name-header{
      display: flex;
      align-items: top;
    }

    .name-back{
      width: 40px;
      height: 48px;
      background-image: url('./icons/arrow-left.svg');
      background-position: center left;
      vertical-align: middle;
      background-repeat: no-repeat;
      background-size: 30px;

    }

    .name-main{
      font-size: 30px;
    }

    .name-secondary{
      font-size: 12px;
    }

    /*.icon{
      display: inline-block;
      width: 15px;
      height: 15px;
      vertical-align: middle;
      background-image: url('./icons/snake-sit.svg');
      background-size: 100%;
    }*/

    .diagnosis-content{
      padding: 20px;
      background: var(--blue);
      color: var(--white);
      max-width: 400px;
      margin: auto;
    }

    .c-grader{
      
      flex: 1;
      margin-bottom: 10px;
    }

    .grader-options{
      
      display: flex;
      flex-direction: row;
      flex:1;
      border-left: 1px solid black;
    }

    .grader-title{
      margin-bottom: 5px;
      width: 150px;
      font-size: 10px;
      font-weight: bold;
    }

    .grader-option{
      
      padding: 10px;
      border: 1px solid black;
      border-left: none;
    }

    .selector-text{
      
    }

    .selector-byline{
      font-size: 10px;
      opacity: 0.5;
    }

    .c-tag-selector{

    }

    .tag-option{
      display: flex;
      border: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 10px;
      position: relative;
      background: rgba(255, 255, 255, 0.05);
      vertical-align: top;
      flex:1;
    }

    .tag-suboption{
      
      white-space: nowrap;
      padding: 10px;
      vertical-align: middle;
      min-height: 100%;
      box-sizing: border-box;
      border-right: 1px dashed rgba(255, 255, 255, 0.1);
      position: relative;
      cursor: pointer;
      flex: 1;
    }

    .tag-suboption:last-of-type{
      border-right: none;
    }

    .tag-byline, .dd-byline{
      font-size: 12px;
      opacity: 0.5;
    }

    .tag-suboption.selected{
      box-shadow: inset 0px -2px white;
    }

    .tag-suboption.selected:after{
      content: "";
      width: 3px;
      height: 7px;
      border-right: 2px solid white;
      border-bottom: 2px solid white;
      position: absolute;
      right: 6px;
      top: 2px;
      transform: rotate(45deg);
    }

    .c-dd-selector{
      display: block;
      border: 1px solid rgba(255, 255, 255, 0.1);
      margin-bottom: 10px;
      margin-right: 10px;
      position: relative;
      background: rgba(255, 255, 255, 0.05);
      vertical-align: top;
    }

    .dd-option{
      padding: 10px;
    }

    .dd-list{
      position: absolute;
      top: 0px;
      left: 0px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: none;
    }

    .dd-label:after{
      content: "";
      width: 15px;
      height: 15px;
      border-right: 1px solid white;
      border-bottom: 1px solid white;
      position: absolute;
      right: 25px;
      top:20px;
      transform: rotate(45deg);
      opacity: 0.5;
    }

    .c-page-launcher{

      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 10px;
      color: rgba(255, 255, 255, 0.5);
      position: relative;
    }

    .c-page-launcher:after{
      content: "";
      background: url('./icons/arrow-right.svg');
      position: absolute;
      width: 35px;
      background-size: 20px;
      background-position: center;
      background-repeat: no-repeat;
      top: 0px;
      right: 0px;
      bottom: 0px;
      display: block;
      opacity: 0.5;
    }

    .search-pillar-page{
      display: none;
      padding: 20px;
      min-width: 350px;
    }

    .search-pillar-page.active{
      display: block;
    }

  </style>
  <script type="text/javascript" src="jq.js"></script>
  <script type="text/javascript">
    $(function(){

      var words = "Nulla viverra mi et turpis congue dignissim. Sed gravida aliquam libero, id porttitor neque consectetur vel. Curabitur dignissim massa vel est maximus, tincidunt pellentesque mi feugiat. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Ut commodo lacinia lacus a faucibus. Integer ac nunc nec lectus eleifend euismod nec in metus. Nunc consectetur odio ut augue eleifend viverra. Proin consectetur venenatis imperdiet.Suspendisse eu pellentesque purus. In id hendrerit orci. Praesent rhoncus commodo sagittis. Donec porttitor orci vel sollicitudin lobortis. In hac habitasse platea dictumst. Maecenas pharetra quam eu ipsum dignissim dignissim. Etiam ullamcorper quam non nunc malesuada, eu egestas enim tempor. Nunc molestie, dui et commodo sagittis, odio magna varius dolor, convallis venenatis ex quam vel libero. Maecenas molestie euismod risus ac sollicitudin. Ut orci erat, lobortis id vulputate eget, elementum at lorem. Proin pretium tempor convallis. Integer a commodo dolor.".split(' ');

      var qs = [
        /*{
          t:"Is the person's life in danger?",
          o:{
            'yes':doFirstAid,
            'no':doNextQuestion,
          }
        },*/{
          t:"Location",
          st:'including recent travel',
          c:{ type:'lister', preload:['ðŸ‡¦ðŸ‡º Australia'], add:'Add location' },
          o:{
            'done':doNextQuestion,
          }
        },
        {
          t:"Keywords",
          c:{ type:'input', clue:'e.g. Brown Snake, Mushroom, Spider', prompts:['Brown snake','Spider','Mushroom'], preload:['Snake','Spider','Mushroom'] },
          o:{
            'not sure':doNextQuestion,
            'search':doNextQuestion,
          }
        },
        
        {
          t:"Biosphere",
          c:{ type:'selector',
            o:[
              {t:'land', icon:'./icons/land.svg'},
              {t:'salt water', icon:'./icons/sea.svg'},
              {t:'fresh water', icon:'./icons/water.svg'}
            ]
          },
          o:{
            'done':doNextQuestion
          }
        },

        {
          t:'Diagnostic Effects',
          c:{
            type:'page',
            empty:'None identified',
            to:'.search-pillar-page.diagnostic-effects',
          }
        },

        {
          t:'Lab/Blood Indicators',
          c:{
            type:'page',
            empty:'Normal/NA',
            to:'.search-pillar-page.lab-indicators',
          }
        },

        /*{
          t:"Symptoms",
          c:{ type:'selector',
            o:[
              {t:'wound', icon:'./icons/wound.svg'},
              {t:'nausea', icon:'./icons/nausea.svg'},
              {t:'dizzy', icon:'./icons/dizzy.svg'}
            ]
          },
          o:{
            'done':doNextQuestion
          }
        }*/
      ]

      var diagnosis = [
        /*{
          t:'Diagnostic Effects',
          c:{ 
            type:'grader-list', 
            l:[
              { t:'Local Effects', o:['minimal','significant'] },
              { t:'General Systemic Effects', o:['Unlikely','Possible'] },
              { t:'Neurotoxic Paralytic Effects', 
                o:['No effects','Flaccid Paralysis'],
                b:['Not even ptsosis','Including any ptsosis']
               },
              { t:'Neurotoxic Excitatory Effects', 
                o:['Unlikely','Possible'],
                b:['','e.g. catechlomaine storm'] 
              },
              { t:'Myotoxic Effects', o:['None','Mild','Possible'],
                b:['CK < 500 IU/I','500-1500 IU/I after 12 hours','CK > 1500 IU/I']
               },
               {
                t:'General Haematologic Effects',
                o:['Evident'],
                b:['Coagulopothy exists'],
               }
            ]
          }
        },*/
        {
          t:'Common Effects',
          st:'Select all that apply',
          c:{
            type:'tag-selector',
            o:[
              {t:'Significant Local Effects'},
              {o:[
                {t:'Mytoxicity',b:'CK > 1500 IU/I'},
                {t:'Mild Mytoxicity',b:'500-1500 IU/I after 12 hours'},
                ]},
              {t:'Flaccid Paralysis',b:'including any ptsosis'},
              {t:'Neurotoxic Excitatory Effects',b:'e.g. catechlomaine storm'},
              {t:'Renal Damage/Failure'},
              {t:'Local Neurotoxin Injury'},
              
              {
                o:[
                {t:'Cardiotoxicity'},
                {t:'Hyperkalaemic Cardiotoxicity',b:'Secondary to myolysis'},
                ]
              }
            ]
          }
        },
        {
          t:'Haematologic Effects',
          st:'Select all that apply',
          c:{
            type:'tag-selector',
            o:[{t:'Coagulopothy'},{t:'Anaemia'},{t:'Haemolysis'}]
          }
        },
        {
          t:'Other Effects',
          st:'Select all that apply',
          c:{
            type:'tag-selector',
            o:[
              { t:'Anterior pituritary haemorrage'},
              { o:[
              {t:'Early angio-oedema'},
              {t:'Early angio-oedema',b:'+ Shock + GI bleeds'},
              ]},
              {t:'Metallic taste in mouth',b:'and/or fasciculations'},
              {t:'Venom spit ophthalmia'}
            ],
          }
        },
      ]

      var labs = [
        {
          t:'Bloodwork',
          st:'Select any non-normal indicators',
          c:{
            type:'dd-list',
            o:[
              {
                t:'PT/INR',
                o:[
                  {t:'Grossly Prolonged'},
                  {t:'Prolonged'},
              ]},
              {
                t:'aPTT',
                o:[
                  {t:'Grossly Prolonged'},
                  {t:'Prolonged'},
              ]},
              {
                t:'Fibrination',
                o:[
                  {t:'Defibrination'},
                  {t:'Low'},
                  {t:'Raised'},
                ]
              },
              {
                t:'FDP/XDP',
                o:[
                  {t:'Grossly Elevated'},
                  {t:'Elevated'},
                ]
              },
              {
                t:'Thrombocytopenia',
                o:[
                  {t:'Primary'},
                  {t:'Severe'},
                  {t:'Secondary'},
                ]
              },
              {
                t:'CK',
                o:[
                  {t:'Grossly Elevated'},
                  {t:'Elevated'},
                  {t:'Mildly'},
                ]
              },
              /*{ t:'Secondary Renal Failure' },
              { t:'K++ Secondary Elevation' },
              { t:'WCC Leukocytosis' },
              { t:'Lymphomenia' },*/
              {
                t:'Hb',
                o:[
                    { t:'Anaemia' },{ t:'Haemolytic Anaemia' }
                  ]
              },
              {
                t:'APaO2',
                o:[
                { t:'Low', b:'Secondary to paralytic respiratory failure' },
                { t:'Low', b:'Secondary to pulmonary embolism' }]},
               {
                t:'WBCT',
                o:[
                { t:'Prolonged', b:'Or not clotting' },
                { t:'Rapid Clotting' }]},
            ]
          }
        }
      ]

      var iq = -1;

      function makeLister(c){
        var $e = $('<div class="c-lister">');

        var $ul = $('<ul>').appendTo($e);
        if(c.preload) for(var n in c.preload) $('<li>').appendTo($ul).text(c.preload[n]);

        function addToList(){
          $('<li>').appendTo($ul).text('-');
        }

        $('<button>').appendTo($e).text(c.add).click(addToList);
        return $e;
      }

      function makeTagSelector(c){

        var $e = $('<div class="c-tag-selector">');
        if(c.dd) $e.addClass('dd');

        for(var n in c.o){
          var $o = $('<div class="tag-option">').appendTo($e);
          var o = c.o[n].o?c.o[n].o:[c.o[n]];

          for(var m in o){
            var $el = $('<div class="tag-suboption">').appendTo($o).click(function(){
              
              var b = $(this).hasClass('selected');

              $(this).closest('.tag-option').find('.tag-suboption').removeClass('selected');
              
              if(!b) $(this).addClass('selected');
            })
            $('<p class="tag-text">').appendTo($el).text(o[m].t);

            if(o[m].b) $('<p class="tag-byline">').appendTo($el).text(o[m].b);
          }
        }
        return $e;
      }

      function makeDDSelector(c){

        var $e = $('<div class="c-dd-selector">');

        var $label = $('<div class="dd-label">').appendTo($e);
        var $list = $('<div class="dd-list">').appendTo($e);

        var o = c.o;
        o.unshift({t:c.t,b:'Normal or NA'});

        for(var n in o){

          var $o = $('<div class="dd-option">').appendTo($list);
          
          $('<p class="dd-text">').appendTo($o).text(o[n].t);
          if(o[n].b) $('<p class="dd-byline">').appendTo($o).text(o[n].b);
        }

        $label.html($e.find('.dd-option').eq(0).clone());

        return $e;
      }

      function makeDDList(c){

        var $e = $('<div class="c-dd-list">');

        for(var n in c.o) makeDDSelector(c.o[n]).appendTo($e);

        return $e;
      }

      function makePageLauncher(c){
        var $e = $('<div class="c-page-launcher">').text(c.empty);
        $e.click(function(){
          $('.search-pillar-page').removeClass('active');
          $(c.to).addClass('active');
        })
        return $e;
      }

      function makeSelector(c){

        var $e = $('<div class="c-selector">');
        for(var n in c.o){
          var $o = $('<div class="selector-option">').appendTo($e);
          var o = c.o[n].o?c.o[n].o:[c.o[n]];

          for(var m in o){
            var $el = $('<div class="selector-suboption">').appendTo($o);
            if(o[m].icon) $('<img src="'+o[m].icon+'">').appendTo($el);
            $('<p class="selector-text">').appendTo($el).text(o[m].t);

            if(o[m].b) $('<p class="selector-byline">').appendTo($el).text(o[m].b);
          }

          $o.css('flex-grow',o.length);
          
        }
        return $e;
      }

      function makeRollingPrompts(prompts){
        var $p = $('<div class="prompts">');
        var $a = $('<p>').appendTo($p).text(prompts[0]);
        var $b = $('<p>').appendTo($p).text(prompts[1]);

        var i = -1;

        function next(){
          i++;
          $a.text(prompts[(i)%prompts.length]).css({top:0}).delay(800).animate({top:'-100%'},500);
          $b.text(prompts[(i+1)%prompts.length]).css({top:0}).delay(800).animate({top:'-100%'},500,next);
        }

        next();

        return $p;
      }

      function makeInput(c){
        var $e = $('<div class="c-input">');
        var $inner = $('<div style="position:relative;margin-bottom:10px;">').appendTo($e);
        //if(c.clue) $('<p class="hint">').text(c.clue).appendTo($e);
        $('<input>').appendTo($inner);
        if(c.prompts) makeRollingPrompts(c.prompts).appendTo($inner);
        if(c.preload){
          for(var n in c.preload){
            $('<p class="capsule clear">').appendTo($e).text(c.preload[n]);
          }
        }
        return $e;
      }

      function makeGrader(c){
        var $e = $('<div class="c-grader">');
        var $t = $('<div class="grader-title">').appendTo($e).text(c.t);
        var $os = $('<div class="grader-options">').appendTo($e);
        for(var n in c.o){
          var $o = $('<div class="grader-option">').appendTo($os).text(c.o[n]);
          if(c.b && c.b[n]) $('<p class="byline">').appendTo($o).text(c.b[n]);
        }
        return $e;
      }

      function doFirstAid(){
        doNextQuestion();
      }

      function doNextQuestion($el,q){
        

        var $q = $('<div class="question">').appendTo($el);
        $('<p class="question-text">').appendTo($q).text( q.t );
        $('<p class="question-subtext">').appendTo($q).text( q.st );
        
        if(q.c){
          if(q.c.type == 'page') makePageLauncher(q.c).appendTo($q);
          if(q.c.type == 'input') makeInput(q.c).appendTo($q);
          if(q.c.type == 'lister') makeLister(q.c).appendTo($q);
          if(q.c.type == 'selector') makeSelector(q.c).appendTo($q);
          if(q.c.type == 'tag-selector') makeTagSelector(q.c).appendTo($q);
          if(q.c.type == 'dd-list') makeDDList(q.c).appendTo($q);
          if(q.c.type == 'grader') makeGrader(q.c).appendTo($q);
          if(q.c.type == 'grader-list'){
            for(var n in q.c.l) makeGrader(q.c.l[n]).appendTo($q);
          }
        } 

        if(q.o){
          var $o = $('<div class="options">').appendTo($q);
          for(var n in q.o) $('<div class="option">').appendTo($o).text(n).click(function(){
            $o.hide();
            q.o[n]();
          });
        }
      }



      for( var n in qs ) doNextQuestion($('.search-pillar-content'), qs[n]);
      
      for( var n in diagnosis ) doNextQuestion($('.diagnostic-effects'), diagnosis[n]);
      for( var n in labs ) doNextQuestion($('.lab-indicators'), labs[n]);

      $('<button class="closer">').appendTo('.diagnostic-effects').text('Show results');
      $('.advanced-diagnosis-button').click(function(){
        $('.modal-diagnosis').addClass('active');
        $('search-pillar').addClass('responsive');
      })


      var sneks = [1,2,3,4,5,6]

      for(var i=0; i<50; i++){
        var $o = $('<div class="organism">').appendTo('.organisms').click(function(){
          $('.modal-organism').addClass('active');
        });
        if(i<3) $o.addClass('risky');
        //$('<img src="https://picsum.photos/id/'+(106+i)+'/200/100">').appendTo($o);
        $('<img height=120 src="http://www.toxinology.com/images/snakes/SNP0521'+sneks[i%sneks.length]+'.jpg">').appendTo($o);
        $('<p>').appendTo($o).text(words[i*2]+' '+words[i*2+1]);
      }


      $p = $('.dangerousness path');
      $p.each(function(n){
        
        var r1 = -Math.PI + Math.PI/$p.length * n;
        var r2 = -Math.PI + Math.PI/$p.length * (n+1);

        var x1 = 50+Math.cos(r1)*50;
        var y1 = 50+Math.sin(r1)*50;

        var x2 = 50+Math.cos(r2)*50;
        var y2 = 50+Math.sin(r2)*50;

        $(this).attr('d','M '+x1+' '+y1+' A 50 50 0 0 1 '+x2+' '+y2);
      })

      $('.modal .closer').click(function(){
        $(this).closest('.modal').removeClass('active');
      })

      $('.search-pillar-back').click(function(){
        $('.search-pillar-page').removeClass('active');
        $('.search-pillar-home').addClass('active');
      })
    })
  </script>
</head>
<body>
  
  <!--<div class="modal modal-diagnosis">
    <div class="modal-panel diagnosis">
      <div class="diagnosis-content">
        <div class="name-header">
            <div class='name-back closer'></div>
            <div class="name-names">
              <div class='name-main'>Diagnostic Effects</div>
            </div>
          </div>
          <br>
      </div>

    </div>
  </div>-->

  <div class="pillars">
    <div class="search-pillar">
      <div class="search-pillar-page search-pillar-home active">
        <div class="search-pillar-header"><div class="logo"></div></div>
        <div class='search-pillar-content'></div>
      </div>
      <div class="search-pillar-page diagnostic-effects">
        <div class="name-header">
            <div class='name-back search-pillar-back'></div>
            <div class="name-names">
              <div class='name-main'>Diagnostic Effects</div>
            </div>
          </div>
          <br>
      </div>
      <div class="search-pillar-page lab-indicators">
        <div class="name-header">
            <div class='name-back search-pillar-back'></div>
            <div class="name-names">
              <div class='name-main'>Lab Indicators</div>
            </div>
          </div>
          <br>
      </div>

      <!--button class='advanced-diagnosis-button' style="margin:0px 20px;">Add Diagnostic Effects</button>
      <button class='advanced-diagnosis-button' style="margin:0px 20px;">Add Lab Results</button>
      <div class="advice">
        <p>If life is in <b>immediate danger</b>, manage any acute medical problems to stabilise the situation before continuing.</p>
      </div-->
    </div>
    <div class="organism-pillar">
      <div class="organisms-header"><p>3256 possible organisms</p><select><option>Sort by dangerousness</option></select></div>

      <p class="capsule risk high"><img class='icon' src="./icons/alert-triangle.svg"/>3 High Risk</p>
      <p class="capsule"><span class="icon snake"></span> 99+ snakes</p>
      <p class="capsule">52 spiders</p>
      <p class="capsule">12 plants</p>
      <div class="organisms">

      
    
    <div class="modal modal-organism">
      <div style="text-align:left;padding:15px 20px;background: var(--gray);">
        <button class="secondary closer"><img style="position:relative;vertical-align: middle;margin-right: 5px;top:-1px;" width=15 src='./icons/arrow-left-blue.svg'>Back to search results</button>
      </div>
      <div class="modal-panel">
        
          
        <div class="modal-header">
          
          
          
          <div class="name-header">
            <!--div class='name-back closer'></div-->
            <div class="name-names">
              <div class='name-main'>King Brown Snake</div>
              <div class='name-secondary'>AKA Mulga Snake</div>
            </div>
          </div>
         
          <div style="height:10px;"></div>
          
          <p class="capsule risk high"><img class='icon' src="./icons/alert-triangle.svg"/>High Risk</p>

          <p class="capsule-list"><span><!--img class='icon' src="./icons/book-open.svg"/-->Pseudechis australis</span><span>Elapidae</span><span>Elapinae</span><span>Pseudechis</span><span>australis</p>
          <p class="capsule">Australia</p>
          <!--div class="c-dangerousness">
            <svg class='dangerousness' viewBox='-20 -20 140 70' width=150 height=75 stroke='black' stroke-width=10>
              <path d=''/>
              <path d=''/>
              <path d=''/>
              <path stroke-width=15 d=''/>
              <path d=''/>
            </svg>
            <div class="needle"></div>
            <p>Lethal</p>
          </div-->

          
          <div style="height:10px;"></div>
          <div 
            style="margin-right:10px;border:1px solid var(--gray);background-position:center;background-size:150%;width:200px;height:200px;display:inline-block;background-image:url(./australia.png)">
            </div>
          <img height=200 style="border:1px solid var(--gray);" src="http://www.toxinology.com/images/snakes/SNP05211.jpg">

        
        </div>
        <div class="modal-content">
        <ul class="modal-menu">
          <li>First Aid</li>
          <li>Diagnosis</li>
          <li>Treatment</li>
          <li>Lab Findings</li>
        </ul>
        <section>
          <hr>
        <h2>First Aid</h2>
        <h3>For all Australian and New Guinean snakebites</h3>
        <br>
        <img src="./icons/distance.png" width="30">
          <p><b>Create safe distance from Snake.</b></p>
          <br>
          <img src="./icons/stop.png" width="30">
          <p><b>Immobilise and calm victim.</b> Most snake bites from venemous snakes DO NOT ENVENOMATE the victim. If envenomated, it will take hours or days to spread through the system. Modern treatment is highly effective.</p>
          <br>
          <img src="./icons/hand.png" width="30">
          <p><b>Don't handle the wound.</b>  The wound must not be wiped or cleaned in any way, as this may interfere with later venom detection and the wound must not be massaged.</p>
          <br>
          <img src="./icons/ring.png" width="30">
          <p><b>Remove jewelery on bitten limb.</b> All rings or other jewellery on the bitten limb, especially on fingers, should be removed, as they may act as tourniquets if oedema develops.</p>
          <br>
        </section>
        <hr>
        <h2>Key Diagnostic Effects</h2>
        <p class="capsule">Local pain & swelling</p>
        <p class="capsule">myolysis</p>
        <p class="capsule">anticoagulant coagulopathy</p>
        <p class="capsule">renal failure</p>
        <br><br>
        <hr>
        <h2>Treatment</h2>
        <div class="treatment">
        <p>Bites by mulga snakes are characterized by local pain, swelling and systemic myolysis, occasionally anticoagulant coagulopathy, and secondary renal failure. Rarely, there may be evidence of mild paralysis, usually limited to ptosis only. Probably most bites will develop at least some systemic envenoming, so many cases will require antivenom therapy. Admit all cases of definite or suspected bites.</p><p>On presentation, establish a good IV line, commence IV fluids, take bloods for initial tests ("extended coagulation tests" = PT/INR, aPTT, fibrinogen level***, FDP/XDP, platelet count; CK, urea, creatinine, WCC, K+), perform venom detection on the bite site (if uncertain of identity of snake). (*** fibrinogen level is only useful if it can be reliably measured to very low levels; many labs are unable to do this or may use indirect measurement and in this setting fibrinogen is not a useful test and could be omitted)Unless contraindicated by pre-existing medical conditions, give an IV fluid load (1L over 2-3 hrs in an adult; volume determined by weight in a child), then keep well hydrated thereafter (100-150 mL/hr in an adult), while carefully watching for fluid overload, monitoring fluid input and output. If a first aid bandage is in place over the bitten limb, leave on until the blood tests, venom detection and full examination are complete and results available. To perform venom detection cut away the bandage immediately over the bite area, to swab for venom. Keep the cut-away bandages, in case they are needed later for venom detection.</p><p>If the patient presents with envenoming clearly established, or blood tests show evidence of systemic envenoming (high and/or rising CK, less commonly an anticoagulant coagulopathy, with prolonged PT/INR, aPTT, but normal fibrinogen level and normal or barely elevated FDP/XDP), then commence antivenom therapy prior to removal of first aid. Initial dose should be 1 vial of CSL Black Snake AV IV (only in severe cases would >1 vial be needed initially), diluted up to 1:10 (less in children, to avoid volume overload), with adrenaline ready to treat anaphylaxis, should this occur.</p><p>Repeat blood tests 3 hrs after completion of initial dose of antivenom therapy, to determine if myolysis has been arrested (no further or minimal rise in CK) and any coagulopathy reversed (PT/INR and aPTT falling towards normal). If the CK has continued to climb dramatically, consider giving further antivenom. If the 3hr tests suggest improvement then wait 2-3 hrs and retest. If there is continued improvement, it is likely no further antivenom will be needed. If, however, there has been no improvement or worsening, give further antivenom. The role of antivenom in reversing myolysis is controversial, but given the potential lethality of severe myolysis, further antivenom therapy should always be considered.</p><p>For cases where initial blood tests show no sign of either myolysis (CK) or anticoagulant coagulopathy, no antivenom is required at this stage, but repeat tests 2-3 hrs and 5-6 hrs later and if these show developing envenoming, treat with antivenom, as discussed earlier.</p><p>For cases with myolysis, CK may rise to very high levels, >100,000 IU/L. This is accompanied by muscle pain, tenderness and weakness in most cases. There will also be gross myoglobinuria (red to black urine) and the risk of renal failure. Hyperkalaemia can develop secondary to myolysis and is more severe if there is secondary renal failure. It can cause cardiotoxicity and is potentially lethal and may be difficult to treat.</p><p>The anticoagulant coagulopathy is only rarely associated with significant bleeding and in most cases will be rapidly and completely reversed by antivenom therapy. It is distinguished from the defibrination commonly seen with bites by some other Australian snakes (brown snakes, tiger snakes, taipans etc) by the normal fibrinogen level and absence of high levels of FDP/XDP.</p><p>Mulga snake bites commonly develop both local pain and swelling. The latter may be quite extensive, but local necrosis is rare. The swelling may take several days to > week to settle fully and may look like cellulitis. If there is a strong suspicion of secondary infection with cellulitis, then antibiotic therapy, initially IV, is required, but in most cases of mulga snake bites, antibiotics are not required. Tetanus immunisation status should always be checked and a booster given when indicated, but not until any coagulopathy has been reversed.</p>
      </div>
      </div>
      </div>
    </div>
    </div>
    </div>
  </div>
</body>
</html>